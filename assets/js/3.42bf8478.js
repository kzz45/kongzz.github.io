(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{362:function(a,t,s){a.exports=s.p+"assets/img/copy_dashboard_id.81d86b6f.png"},363:function(a,t,s){a.exports=s.p+"assets/img/dashboard_import.aa18ed4a.png"},364:function(a,t,s){a.exports=s.p+"assets/img/import_dashboard.c718698a.png"},365:function(a,t,s){a.exports=s.p+"assets/img/dashboard_variable.9bdc2f29.png"},366:function(a,t,s){a.exports=s.p+"assets/img/node_exporter.23fe2c78.png"},367:function(a,t,s){a.exports=s.p+"assets/img/invited_email.6d08126d.png"},368:function(a,t,s){a.exports=s.p+"assets/img/invite_user.0cbeb4e4.png"},389:function(a,t,s){"use strict";s.r(t);var e=s(44),r=Object(e.a)({},(function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h1",{attrs:{id:"监控平台之grafana部署"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#监控平台之grafana部署"}},[a._v("#")]),a._v(" 监控平台之Grafana部署")]),a._v(" "),e("h2",{attrs:{id:"下载安装包"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#下载安装包"}},[a._v("#")]),a._v(" 下载安装包")]),a._v(" "),e("p",[e("a",{attrs:{href:"https://grafana.com/grafana/download",target:"_blank",rel:"noopener noreferrer"}},[a._v("官方下载地址"),e("OutboundLink")],1)]),a._v(" "),e("p",[a._v("我们使用的是"),e("strong",[a._v("CentOS")]),a._v("版本")]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("wget")]),a._v(" https://dl.grafana.com/enterprise/release/grafana-enterprise-8.1.3-1.x86_64.rpm\n"),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" yum "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" -y grafana-enterprise-8.1.3-1.x86_64.rpm\n")])])]),e("h2",{attrs:{id:"grafana配置文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#grafana配置文件"}},[a._v("#")]),a._v(" Grafana配置文件")]),a._v(" "),e("p",[a._v("主要配置如下")]),a._v(" "),e("div",{staticClass:"language-ini extra-class"},[e("pre",{pre:!0,attrs:{class:"language-ini"}},[e("code",[e("span",{pre:!0,attrs:{class:"token header"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),e("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("paths")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("data")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/var/lib/grafana")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("logs")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/var/log/grafana")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token header"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),e("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("server")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("http_addr")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("0.0.0.0")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("http_port")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("80")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("; 我们使用MySQL来存储")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token header"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),e("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("database")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("type")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("mysql # 默认的是sqlite3")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("host")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("mysql-host:3306")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("name")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("grafana # MySQL数据库需要提前创建好")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("user")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("user")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("password")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("pasword")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token header"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),e("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("auth.anonymous")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("enabled")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("true # 允许匿名访问")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("org_name")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("org-name # 允许匿名访问的组织名称(这里一定要写对)")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("org_role")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("Viewer # 允许匿名访问的用户的权限是只读")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("; 我们使用SMTP来发送邀请邮件或者告警邮件")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token header"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),e("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("smtp")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("enabled")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("true")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("host")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("smtp地址:端口")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("user")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("用户邮箱")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("password")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("用户密码")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("skip_verify")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("true")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("from_address")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("发送邮件的用户的邮箱")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("from_name")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("Grafana")]),a._v("\n")])])]),e("p",[a._v("遇见问题：80端口的服务启动不了")]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[a._v("setcap "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v("'cap_net_bind_service=+ep'")]),a._v(" /usr/sbin/grafana-server\n")])])]),e("h2",{attrs:{id:"启动服务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#启动服务"}},[a._v("#")]),a._v(" 启动服务")]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[a._v("systemctl "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("enable")]),a._v("  grafana-server\nsystemctl start  grafana-server\n")])])]),e("h2",{attrs:{id:"登录修改admin的密码"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#登录修改admin的密码"}},[a._v("#")]),a._v(" 登录修改admin的密码")]),a._v(" "),e("blockquote",[e("p",[a._v("默认的登录用户名admin密码也是admin")])]),a._v(" "),e("h2",{attrs:{id:"导入node-exporter的dashboard"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#导入node-exporter的dashboard"}},[a._v("#")]),a._v(" 导入Node Exporter的Dashboard")]),a._v(" "),e("p",[a._v("我们使用的是"),e("a",{attrs:{href:"https://grafana.com/grafana/dashboards/8919",target:"_blank",rel:"noopener noreferrer"}},[a._v("1 Node Exporter for Prometheus Dashboard CN v20201010"),e("OutboundLink")],1)]),a._v(" "),e("h3",{attrs:{id:"复制dashboard的id"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#复制dashboard的id"}},[a._v("#")]),a._v(" 复制Dashboard的ID")]),a._v(" "),e("p",[e("img",{attrs:{src:s(362),alt:""}})]),a._v(" "),e("h3",{attrs:{id:"导入grafana"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#导入grafana"}},[a._v("#")]),a._v(" 导入Grafana")]),a._v(" "),e("p",[e("img",{attrs:{src:s(363),alt:"步骤1"}}),a._v(" "),e("img",{attrs:{src:s(364),alt:"步骤2"}})]),a._v(" "),e("h3",{attrs:{id:"细微修改dashboard的变量"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#细微修改dashboard的变量"}},[a._v("#")]),a._v(" 细微修改Dashboard的变量")]),a._v(" "),e("p",[e("img",{attrs:{src:s(365),alt:""}})]),a._v(" "),e("h3",{attrs:{id:"效果图"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#效果图"}},[a._v("#")]),a._v(" 效果图")]),a._v(" "),e("p",[e("img",{attrs:{src:s(366),alt:""}})]),a._v(" "),e("h2",{attrs:{id:"邮件邀请用户"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#邮件邀请用户"}},[a._v("#")]),a._v(" 邮件邀请用户")]),a._v(" "),e("h3",{attrs:{id:"邀请例子"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#邀请例子"}},[a._v("#")]),a._v(" 邀请例子")]),a._v(" "),e("p",[e("img",{attrs:{src:s(367),alt:""}})]),a._v(" "),e("h3",{attrs:{id:"邮件效果图"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#邮件效果图"}},[a._v("#")]),a._v(" 邮件效果图")]),a._v(" "),e("p",[e("img",{attrs:{src:s(368),alt:""}})])])}),[],!1,null,null,null);t.default=r.exports}}]);